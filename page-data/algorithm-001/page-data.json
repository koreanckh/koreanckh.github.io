{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/algorithm-001/",
    "result": {"data":{"cur":{"id":"c071f920-ad3d-5981-b714-f29b5a7f1f30","html":"<h1 id=\"1-테스트\" style=\"position:relative;\"><a href=\"#1-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"1 테스트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 테스트</h1>\n<p>첫글이 제대로 보이는지 테스트</p>","excerpt":"1. 테스트 첫글이 제대로 보이는지 테스트","frontmatter":{"date":"August 28, 2022","title":"첫글 테스트","categories":"블로그 잡담","author":"막걸리에 감자전","emoji":"🔮"},"fields":{"slug":"/algorithm-001/"}},"next":{"id":"9bbf2555-4f9b-5fbf-ac41-ae85bc4d4684","html":"<blockquote>\n<p>amazon-linux 로 생성한 EC2에서 진행하였습니다.</p>\n</blockquote>\n<h2 id=\"1-ec2에서-git-java-설치\" style=\"position:relative;\"><a href=\"#1-ec2%EC%97%90%EC%84%9C-git-java-%EC%84%A4%EC%B9%98\" aria-label=\"1 ec2에서 git java 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. EC2에서 git, java 설치</h2>\n<ul>\n<li>git 설치</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># git 설치</span>\n<span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> <span class=\"token function\">git</span> -y\n\n<span class=\"token comment\"># git 설치 확인</span>\n<span class=\"token function\">git</span> version</code></pre></div>\n<ul>\n<li>java 설치(각자 버전에 맞게)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># OpenJDK 11 설치</span>\n<span class=\"token function\">sudo</span> amazon-linux-extras <span class=\"token function\">install</span> java-openjdk11\n\n<span class=\"token comment\"># OpenJDK 11 설치 확인</span>\njava -version</code></pre></div>\n<h2 id=\"2-git에서-소스-내려받기\" style=\"position:relative;\"><a href=\"#2-git%EC%97%90%EC%84%9C-%EC%86%8C%EC%8A%A4-%EB%82%B4%EB%A0%A4%EB%B0%9B%EA%B8%B0\" aria-label=\"2 git에서 소스 내려받기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. git에서 소스 내려받기</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">git clone {repository URL}</code></pre></div>\n<h2 id=\"3-패키지-빌드\" style=\"position:relative;\"><a href=\"#3-%ED%8C%A8%ED%82%A4%EC%A7%80-%EB%B9%8C%EB%93%9C\" aria-label=\"3 패키지 빌드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 패키지 빌드</h2>\n<blockquote>\n<p>프로젝트 루트 디렉토리에서 실행</p>\n</blockquote>\n<h3 id=\"1-maven\" style=\"position:relative;\"><a href=\"#1-maven\" aria-label=\"1 maven permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(1) maven</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 메이븐 빌드</span>\nmvn package</code></pre></div>\n<p>maven 빌드 후에 <code class=\"language-text\">/target</code>경로에 <code class=\"language-text\">.jar</code> 확장자명으로 파일이 생성된다. 정상적으로 빌드 되었는지 실행해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">java -jar target/demo-0.0.1-SNAPSHOT.jar</code></pre></div>\n<h3 id=\"2-gradle\" style=\"position:relative;\"><a href=\"#2-gradle\" aria-label=\"2 gradle permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(2) gradle</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 1. \"./gradlew\" 파일에 대한 권한 부여</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">chmod</span> <span class=\"token number\">777</span> ./gradlew\n\n<span class=\"token comment\"># 2. gradlew을 이용하여 빌드</span>\n./gradlew clean build</code></pre></div>\n<p>gradle 빌드 후에는 <code class=\"language-text\">/build/libs</code>이하에 <code class=\"language-text\">.jar</code> 파일이 생성된다. 마찬가지로 오류 없이 빌드 되는지 실행해본다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">java -jar build/libs/demo-0.0.1-SNAPSHOT.jar</code></pre></div>\n<h2 id=\"4-deploysh-작성\" style=\"position:relative;\"><a href=\"#4-deploysh-%EC%9E%91%EC%84%B1\" aria-label=\"4 deploysh 작성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. deploy.sh 작성</h2>\n<h3 id=\"1-deploysh-샘플\" style=\"position:relative;\"><a href=\"#1-deploysh-%EC%83%98%ED%94%8C\" aria-label=\"1 deploysh 샘플 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(1) deploy.sh 샘플</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token shebang important\">#!/usr/bin/env shell</span>\n\n<span class=\"token assign-left variable\">REPOSITORY</span><span class=\"token operator\">=</span>/home/<span class=\"token punctuation\">{</span>user-name<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>/<span class=\"token punctuation\">{</span>project-name<span class=\"token punctuation\">}</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"> 현재 구동 중인 애플리케이션 pid 확인\"</span>\n\n<span class=\"token assign-left variable\">CURRENT_PID</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span>pgrep -fl action <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> java <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'{print $1}'</span><span class=\"token variable\">)</span></span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"현재 구동 중인 애플리케이션 pid: <span class=\"token variable\">$CURRENT_PID</span>\"</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> -z <span class=\"token string\">\"<span class=\"token variable\">$CURRENT_PID</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"현재 구동 중인 애플리케이션이 없으므로 종료하지 않습니다.\"</span>\n<span class=\"token keyword\">else</span>\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"> kill -15 <span class=\"token variable\">$CURRENT_PID</span>\"</span>\n  <span class=\"token function\">kill</span> -15 <span class=\"token variable\">$CURRENT_PID</span>\n  <span class=\"token function\">sleep</span> <span class=\"token number\">5</span>\n<span class=\"token keyword\">fi</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"> 새 애플리케이션 배포\"</span>\n\n<span class=\"token comment\"># maven 이나 gradle에 따라 빌드된 jar파일이 생성되는 위치가 다르기 때문에 잘 확인해서 작성해준다.</span>\n<span class=\"token comment\"># 아래 경로는 gradle 기준</span>\n<span class=\"token assign-left variable\">JAR_NAME</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">ls</span> -tr $REPOSITORY/build/libs/*.jar <span class=\"token operator\">|</span> <span class=\"token function\">tail</span> -n <span class=\"token number\">1</span><span class=\"token variable\">)</span></span>      <span class=\"token comment\"># gradle ver</span>\n<span class=\"token comment\">#JAR_NAME=$(ls -tr $REPOSITORY/target/*.jar | tail -n 1)     # maven ver</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"> JAR NAME: <span class=\"token variable\">$JAR_NAME</span>\"</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"> <span class=\"token variable\">$JAR_NAME</span> 에 실행권한 추가\"</span>\n\n<span class=\"token function\">chmod</span> +x <span class=\"token variable\">$JAR_NAME</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"> <span class=\"token variable\">$JAR_NAME</span> 실행\"</span>\n\n<span class=\"token function\">nohup</span> java -jar <span class=\"token variable\">$JAR_NAME</span> <span class=\"token operator\">></span> <span class=\"token variable\">$REPOSITORY</span>/nohup.out <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span><span class=\"token file-descriptor important\">&amp;1</span> <span class=\"token operator\">&amp;</span></code></pre></div>\n<h3 id=\"2-gradle-빌드-후-서버-구동시-주의사항\" style=\"position:relative;\"><a href=\"#2-gradle-%EB%B9%8C%EB%93%9C-%ED%9B%84-%EC%84%9C%EB%B2%84-%EA%B5%AC%EB%8F%99%EC%8B%9C-%EC%A3%BC%EC%9D%98%EC%82%AC%ED%95%AD\" aria-label=\"2 gradle 빌드 후 서버 구동시 주의사항 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(2) gradle 빌드 후 서버 구동시 주의사항</h3>\n<p>gradle 빌드시에 따로 설정을 해주지 않으면 <code class=\"language-text\">*.jar</code>파일과 <code class=\"language-text\">*-plain.jar</code>파일 두개가 생긴다. <code class=\"language-text\">*-plain.jar</code>파일은 의존성이 포함되지 않은 파일이기 때문에 파일 용량도 작고 정상적으로 서버가 구동되지 않는다. 따라서 서버 실행 스크립트를 수정해주거나 gradle 빌드시에 <code class=\"language-text\">*-plain.jar</code>파일이 생성되지 않도록 <code class=\"language-text\">build.gradle</code>파일을 수정 해주어야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"gradle\"><pre class=\"language-gradle\"><code class=\"language-gradle\">jar {\n    enabled = false\n}</code></pre></div>","frontmatter":{"date":"August 28, 2022","title":"AWS EC2에 Spring boot 배포하기!(작성중..)","categories":"AWS","author":"막걸리에 감자전","emoji":"🔮"},"fields":{"slug":"/aws-001/"}},"prev":{"id":"6a799182-8fb3-59b4-97e1-d6b5b65d82a5","html":"<h1 id=\"0-전체적인-흐름\" style=\"position:relative;\"><a href=\"#0-%EC%A0%84%EC%B2%B4%EC%A0%81%EC%9D%B8-%ED%9D%90%EB%A6%84\" aria-label=\"0 전체적인 흐름 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>0. 전체적인 흐름</h1>\n<blockquote>\n<ol>\n<li>Github Action 설정을 통해 빌드 파일을 S3에 업로드 하고, CodeDeploy 를 실행함.</li>\n<li>CodeDeploy 에서 EC2에 배포 실행하도록 명령.</li>\n<li>1단계에서 S3에 올려둔 필드 파일을 EC2에서 가져와 예약된 스크립트 실행.</li>\n</ol>\n</blockquote>\n<h1 id=\"1-s3-만들기\" style=\"position:relative;\"><a href=\"#1-s3-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-label=\"1 s3 만들기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. S3 만들기</h1>\n<p>Github Action으로 만들어진 빌드 압축파일을 업로드 할 S3파일을 만들어주자.<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABbklEQVR42p3S207DMAwG4L7/Y3EBuxggNMRAXc/d2qXn9Ny0/XEymFS2SUCkT46qyLHjao9Pz3hYrbB528JnCbIsQ0qygiMlMvKy/DXNMAzouo6dYcK0HdiOA9f1sGcpnDCBR5HzAkXxg/zG+QUtTFJkZYV+mtCNo9IKSSjNcMuApm3PWlJWFTT3/g7x6wtG34JwTQjvm3XT6BoQ4R6CLhdiIEKpmwZa7tpoqxJz3y1gsW/PZjK2DWZbxwxgnmdFLlmlVngO2PGIjDEUSQyeJCrmcaT2PKUnyWhA5BgXKHmFiRJO5rtKskjYddCO6xXK3Qe1bCsTkW0N1P7gnlrvPVtpHAsdRextzIF3WaFMmFU1wjgBk78LLxHlBaqux0QHBBmvqGkoE3C9QhZF8A8H+L6PiEUIDgEETRDyIE3+momGofZfyRZvuLE8rLc7GAFDU9fo+x7/XacK6ZFDevC8oenRzT1V11HSv5KFVFTQJ6GkTjcMmINaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aws-002-3.png\"\n        title=\"aws-002-3.png\"\n        src=\"/static/9e81f97cd228424119afbdf72508ffdc/37523/aws-002-3.png\"\n        srcset=\"/static/9e81f97cd228424119afbdf72508ffdc/e9ff0/aws-002-3.png 180w,\n/static/9e81f97cd228424119afbdf72508ffdc/f21e7/aws-002-3.png 360w,\n/static/9e81f97cd228424119afbdf72508ffdc/37523/aws-002-3.png 720w,\n/static/9e81f97cd228424119afbdf72508ffdc/302a4/aws-002-3.png 1080w,\n/static/9e81f97cd228424119afbdf72508ffdc/07a9c/aws-002-3.png 1440w,\n/static/9e81f97cd228424119afbdf72508ffdc/81315/aws-002-3.png 1656w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n다른 설정들은 기본 옵션으로 두고 <code class=\"language-text\">버킷 이름</code>만 확인해두자. Github Action 설정 yml파일에 업로드할 S3 버킷 이름을 세팅해줘야 한다.</p>\n<h1 id=\"2-aws-ec2-서버에-codedeploy-설치\" style=\"position:relative;\"><a href=\"#2-aws-ec2-%EC%84%9C%EB%B2%84%EC%97%90-codedeploy-%EC%84%A4%EC%B9%98\" aria-label=\"2 aws ec2 서버에 codedeploy 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. AWS EC2 서버에 CodeDeploy 설치</h1>\n<ol>\n<li>CodeDeploy 설치시 필요한 패키지 설치</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> yum update\n<span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> ruby\n<span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> <span class=\"token function\">wget</span></code></pre></div>\n<ol start=\"2\">\n<li>이전 에이전트 캐싱 정보의 AMI를 정리</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token shebang important\">#!/bin/bash</span>\n<span class=\"token assign-left variable\">CODEDEPLOY_BIN</span><span class=\"token operator\">=</span><span class=\"token string\">\"/opt/codedeploy-agent/bin/codedeploy-agent\"</span>\n<span class=\"token variable\">$CODEDEPLOY_BIN</span> stop\nyum erase codedeploy-agent -y</code></pre></div>\n<p>임시 shell 파일을 만들어서 실행해주자.</p>\n<ol start=\"3\">\n<li>파일 다운로드</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> /home/ec2-user\n\n<span class=\"token comment\">### wget https://{bucket-name}.s3.{region-identifier}.amazonaws.com/latest/install</span>\n<span class=\"token comment\">### 아시아 태평양(서울)인 경우 예시</span>\n<span class=\"token function\">wget</span> https://aws-codedeploy-ap-northeast-2.s3.ap-northeast-2.amazonaws.com/latest/install</code></pre></div>\n<ol start=\"4\">\n<li>다운로드 파일 설치</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">chmod</span> +x ./install\n<span class=\"token function\">sudo</span> ./install auto</code></pre></div>\n<ol start=\"5\">\n<li>설치 확인 및 실행</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">### 상태확인</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">service</span> codedeploy-agent status\n\n<span class=\"token comment\">### 실행</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">service</span> codedeploy-agent start</code></pre></div>\n<p><code class=\"language-text\">The AWS CodeDeploy agent is running</code>라는 메시지가 나오면 성공!</p>\n<blockquote>\n<ul>\n<li>CodeDeploy 설치 : <a href=\"https://docs.aws.amazon.com/ko_kr/codedeploy/latest/userguide/codedeploy-agent-operations-install-linux.html\">https://docs.aws.amazon.com/ko_kr/codedeploy/latest/userguide/codedeploy-agent-operations-install-linux.html</a></li>\n<li>리전별 리소스 키트 버킷 이름 : <a href=\"https://docs.aws.amazon.com/ko_kr/codedeploy/latest/userguide/resource-kit.html#resource-kit-bucket-names\">https://docs.aws.amazon.com/ko_kr/codedeploy/latest/userguide/resource-kit.html#resource-kit-bucket-names</a></li>\n</ul>\n</blockquote>\n<p>AWS에서 서버별로 CodeDeploy 설치방법을 가이드하고 있다.\nAmazon Linux 기준으로 세팅을 하였고, Ubuntu나 Windows 서버를 사용하고 있다면 참고 링크에서 찾아보면 간편하게 설치할 수 있다.</p>\n<h1 id=\"3-github-action-설정\" style=\"position:relative;\"><a href=\"#3-github-action-%EC%84%A4%EC%A0%95\" aria-label=\"3 github action 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Github Action 설정</h1>\n<ol>\n<li>yml파일 만들기.</li>\n</ol>\n<p><code class=\"language-text\">{프로젝트 루트}/.git/workexamples/{파일이름}.yml</code>경로에 파일을 생성해야 Github에 소스가 올라갈때 Action 이벤트가 발생한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABLUlEQVR42m1S2Y6DMAzkubuUIxBIIBwJsFBVqvr/H+e1vRsUKA8jO2CPx0eUlQ3kskUYKOoOat2DqMyOnID/v1P5gTirPhCFAb17wPx4w7S9wa0vtC/o3AaJUECFU0T2j7TQ14Tho1SoTlnIERkqpsREaE4m0nte75bg87xaspF3CKqbuL3bXTCJbEYOpOSvpMTvBdxisfvehqQHQqnHfV7UXtMvqLqDYV5BYzFlHAzLE6rWQo2+1AOMP8+d9EBIltrx5OTXreO2hWygHRYwduOxFLgo8gssJnGJ4YIOCsNZEOGfwh6awfE46AqUGdn64nEmr1sOl8OEOEMzrozaWGx5ZtLOrqya5rfnkpjzUs6EtBSDycpM+K6gaiyfECm+ir+c4TkgPI3Qv8rx+AWfNfkf0a9xdwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aws-002-1.png\"\n        title=\"aws-002-1.png\"\n        src=\"/static/2bf0cb2ea41ea0eb98f987ec40d293d6/37523/aws-002-1.png\"\n        srcset=\"/static/2bf0cb2ea41ea0eb98f987ec40d293d6/e9ff0/aws-002-1.png 180w,\n/static/2bf0cb2ea41ea0eb98f987ec40d293d6/f21e7/aws-002-1.png 360w,\n/static/2bf0cb2ea41ea0eb98f987ec40d293d6/37523/aws-002-1.png 720w,\n/static/2bf0cb2ea41ea0eb98f987ec40d293d6/302a4/aws-002-1.png 1080w,\n/static/2bf0cb2ea41ea0eb98f987ec40d293d6/07a9c/aws-002-1.png 1440w,\n/static/2bf0cb2ea41ea0eb98f987ec40d293d6/765b7/aws-002-1.png 3418w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n<code class=\"language-text\">Github > repository > Action탭</code>에서 검색하여 템플릿을 활용하여 만들 수도 있고, 직접 해당 경로에 파일을 만들어서 commit 해도 작성해도 좋다.</p>\n<ol start=\"2\">\n<li>yml 예시.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Java CI with Gradle\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> main <span class=\"token punctuation\">]</span>\n  <span class=\"token key atrule\">pull_request</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> main <span class=\"token punctuation\">]</span>\n\n<span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">AWS_REGION</span><span class=\"token punctuation\">:</span> ap<span class=\"token punctuation\">-</span>northeast<span class=\"token punctuation\">-</span><span class=\"token number\">2</span>\n  <span class=\"token key atrule\">S3_BUCKET_NAME</span><span class=\"token punctuation\">:</span> example<span class=\"token punctuation\">-</span>backend<span class=\"token punctuation\">-</span>bucket\n  <span class=\"token key atrule\">CODE_DEPLOY_APPLICATION_NAME</span><span class=\"token punctuation\">:</span> example<span class=\"token punctuation\">-</span>backend<span class=\"token punctuation\">-</span>codedeploy\n  <span class=\"token key atrule\">CODE_DEPLOY_DEPLOYMENT_GROUP_NAME</span><span class=\"token punctuation\">:</span> codedeploy<span class=\"token punctuation\">-</span>group\n\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\">### 1. 기본 체크아웃</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n\n    <span class=\"token comment\">### 2. JDK 11 설정</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Set up JDK 11\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>java@v1\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">java-version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">11</span>\n\n    <span class=\"token comment\">### 3.properties 파일 생성.</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> make application<span class=\"token punctuation\">-</span>prod.properties\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        cd ./src/main/resources\n        echo \"${{ secrets.PROPERTIES }}\" > ./application-prod.properties</span>\n      <span class=\"token key atrule\">shell</span><span class=\"token punctuation\">:</span> bash\n\n    <span class=\"token comment\">### 4.gradlew 권한 생성.</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Grant execute permission for gradlew\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> chmod +x gradlew\n\n    <span class=\"token comment\">### 5.빌드 시작</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build with Gradle\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> gradle/gradle<span class=\"token punctuation\">-</span>build<span class=\"token punctuation\">-</span>action@0d13054264b0bb894ded474f08ebb30921341cee\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">arguments</span><span class=\"token punctuation\">:</span> clean build <span class=\"token punctuation\">-</span>x test\n\n    <span class=\"token comment\">### 6. AWS 인증</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Configure AWS credentials\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> aws<span class=\"token punctuation\">-</span>actions/configure<span class=\"token punctuation\">-</span>aws<span class=\"token punctuation\">-</span>credentials@v1\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">aws-access-key-id</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.AWS_ACCESS_KEY_ID <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">aws-secret-access-key</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.AWS_SECRET_ACCESS_KEY <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">aws-region</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> env.AWS_REGION <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">### 7. S3 등록</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Upload S3\n      <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">AWS_ACCESS_KEY_ID</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.AWS_ACCESS_KEY_ID <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">AWS_SECRET_ACCESS_KEY</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.AWS_SECRET_ACCESS_KEY <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        aws deploy push \\\n          --application-name ${{ env.CODE_DEPLOY_APPLICATION_NAME }} \\\n          --ignore-hidden-files \\\n          --s3-location s3://$S3_BUCKET_NAME/$GITHUB_SHA.zip \\\n          --source .</span>\n\n    <span class=\"token comment\">### 8. CdoeDeploy 실행</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy to AWS EC2 from S3\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        aws deploy create-deployment \\\n          --application-name ${{ env.CODE_DEPLOY_APPLICATION_NAME }} \\\n          --deployment-config-name CodeDeployDefault.AllAtOnce \\\n          --deployment-group-name ${{ env.CODE_DEPLOY_DEPLOYMENT_GROUP_NAME }} \\\n          --s3-location bucket=$S3_BUCKET_NAME,key=$GITHUB_SHA.zip,bundleType=zip</span></code></pre></div>\n<p><code class=\"language-text\">env</code>관련 변수들은 yml파일 상단에 선언후 사용하였고,\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABWElEQVR42n1S2XKCQBD0WSMgsCcsxyIYq5JKVV7y/1/WmV6VJJbmoZndYbbn6NmUusVBULsePBOVCahsByO+r7bFSVvscoWXQifklcNBNchKi/3B/MGGAQwuhYRBvPNHF1/RTWco8ddMQCtJaLt4RlzeUdR+jV8J+aGTFbnumEjpCySUh6aNsO2ULKF8RF63K8Gt6hsSISt0YYKSFnmmzw8zfFxQuS4lI5QbhHCEbiSJgK0/rVA3Y5rllrMSX2YsssZhr+S/+JiI1bNt388YBMV/hNYPcM2AWnlkci9sg8I10p5LlRDldY6Ksb5HLqI8JpTsn+OEj+OCaBxmUdVJa0ba0vKYIAk3gW1TmOKq8tMKexcSbKlgSp0ECiIKiS6zu4DCDPNb2oDfM7zZlbBmcDhiJ/ftdY24Ou14SgjjRfXA+7Ckqu/Jkso/JWtkd0t6vxK/sX8QS/sNBa/7qVwB5hcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"aws-002-2.png\"\n        title=\"aws-002-2.png\"\n        src=\"/static/d67465e9689e4678cb35790c57a642dc/37523/aws-002-2.png\"\n        srcset=\"/static/d67465e9689e4678cb35790c57a642dc/e9ff0/aws-002-2.png 180w,\n/static/d67465e9689e4678cb35790c57a642dc/f21e7/aws-002-2.png 360w,\n/static/d67465e9689e4678cb35790c57a642dc/37523/aws-002-2.png 720w,\n/static/d67465e9689e4678cb35790c57a642dc/302a4/aws-002-2.png 1080w,\n/static/d67465e9689e4678cb35790c57a642dc/07a9c/aws-002-2.png 1440w,\n/static/d67465e9689e4678cb35790c57a642dc/765b7/aws-002-2.png 3418w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n<code class=\"language-text\">secrets</code>변수들은 `Settins > Secrets > Actions’에 설정을 해두고 사용했다.</p>\n<p>앞에서 살짝 언급했듯이 Github Action에서의 역할은 <strong>Github 자체 서버에서 소스를 빌드</strong>하고, 그 파일을 <strong>압축하여 AWS S3에 업로드</strong> 후 <strong>AWS CodeDeploy를 실행</strong>명령을 내려주는 것이다.</p>","frontmatter":{"date":"August 29, 2022","title":"Github Action + AWS EC2 CodeDeploy + S3를 이용하여 자동 배포 하기 (1/2)","categories":"블로그 AWS Git","author":"막걸리에 감자전","emoji":"💻"},"fields":{"slug":"/aws-002-github-action-with-codedeploy/"}},"site":{"siteMetadata":{"siteUrl":"https://koreanckh.github.io","comments":{"utterances":{"repo":""}}}}},"pageContext":{"slug":"/algorithm-001/","nextSlug":"/aws-001/","prevSlug":"/aws-002-github-action-with-codedeploy/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}